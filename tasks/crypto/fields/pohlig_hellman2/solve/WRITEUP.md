Так как порядок случаный каждый раз, он может содержать маленькие факторы. Вы можете переподключаться, пока не получите удобные для вас подгруппы, по которым легко считается дискретный логарифм.
Потом, можете объеденить решение при помощи CRT.